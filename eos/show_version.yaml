---
- name: parse show version

  facts:
    system_mac: "{{ macaddr.0 }}"
    uptime: "{{ uptime.0 }}"
    version:
      string: "{{ version.0 }}"
      major: "{{ version.0.split('.')[0] }}"
      minor: "{{ version.0.split('.')[1] }}"
      maint: "{{ version.0.split('.')[2] }}"
    memory:
      total: "{{ total_mem.0 }}"
      free_mem: "{{ free_mem.0 }}"

  matches:
    - pattern: "image version:\\s+(.+)"
      match_var: version

    - pattern: "MAC address:\\s+(.+)"
      match_var: macaddr

    - pattern: "Total memory:\\s+(\\d+)"
      match_var: total_mem

    - pattern: "Free memory:\\s+(\\d+)"
      match_var: free_mem

    - pattern: "Uptime:\\s+(.+)"
      match_var: uptime


